<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Karaoke Remote</title>
<style>
body{background:#0f2027;color:#fff;font-family:sans-serif;text-align:center;margin:0;padding:0;}
input,button{padding:10px;border:none;border-radius:5px;margin:5px;}
button{background:#1db954;color:#fff;cursor:pointer;}
.song{background:#203a43;padding:8px;margin:6px;border-radius:6px;cursor:pointer;}
.song:hover{background:#2c5364;}
#results,#playlist{max-width:600px;margin:auto;}
#controls button{background:#FFD700;color:#000;font-weight:bold;margin:5px;}
</style>
</head>
<body>
<h2>üì± THE LINKS KTV - Remote</h2>
<input id="search" placeholder="Cari lagu karaoke..." />
<button onclick="doSearch()">Cari</button>
<div id="results"></div>
<hr>
<h3>üéµ Playlist Saat Ini</h3>
<div id="playlist"></div>
<hr>
<h3>üéÆ Kontrol Pemutar</h3>
<div id="controls">
  <button onclick="sendControl('play')">‚ñ∂Ô∏è Play</button>
  <button onclick="sendControl('pause')">‚è∏Ô∏è Pause</button>
  <button onclick="sendControl('next')">‚è≠Ô∏è Next</button>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js"></script>

<script>
// === Firebase Config ===
const firebaseConfig = {
  apiKey: "AIzaSyBnW5cUpoHzUpdN0UuVR5q8D7Epzuh46MY",
  authDomain: "karaoke-remote.firebaseapp.com",
  projectId: "karaoke-remote",
  storageBucket: "karaoke-remote.firebasestorage.app",
  messagingSenderId: "780368521995",
  appId: "1:780368521995:web:9175227e4529393d8f900e",
  measurementId: "G-6BFKKTY4CK",
  databaseURL: "https://karaoke-remote-default-rtdb.firebaseio.com"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();
const API_KEY = "AIzaSyDRqyB5XtgdHTtDVbhuIR5cL6OqDTZlFgE";

async function doSearch(){
  const q = document.getElementById("search").value.trim();
  const resDiv = document.getElementById("results");
  if(!q) return;
  resDiv.innerHTML = "<i>Mencari...</i>";
  const url = `https://www.googleapis.com/youtube/v3/search?part=snippet&type=video&maxResults=8&q=${encodeURIComponent(q+' karaoke')}&key=${API_KEY}`;
  const resp = await fetch(url);
  const data = await resp.json();
  resDiv.innerHTML = "";
  data.items.forEach(item=>{
    const div = document.createElement('div');
    div.className = "song";
    div.innerHTML = `<b>${item.snippet.title}</b><br><small>${item.snippet.channelTitle}</small>`;
    div.onclick = ()=>addToPlaylist(item);
    resDiv.appendChild(div);
  });
}

function addToPlaylist(item){
  db.ref("karaoke/playlist").once("value").then(snap=>{
    const list = snap.val() || [];
    list.push({id:item.id.videoId,title:item.snippet.title});
    db.ref("karaoke/playlist").set(list);
  });
}

db.ref("karaoke/playlist").on("value", snap=>{
  const list = snap.val() || [];
  const p = document.getElementById("playlist");
  p.innerHTML = "";
  list.forEach((s,i)=>{
    const div = document.createElement("div");
    div.className = "song";
    div.innerHTML = `${i+1}. ${s.title}`;
    p.appendChild(div);
  });
});

function sendControl(action){
  db.ref("karaoke/control").set({action});
}
</script>
</body>
</html>
